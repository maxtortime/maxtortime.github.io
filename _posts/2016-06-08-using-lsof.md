---
tags:
  - 간단팁
layout: post
title: 'lsof 명령어 사용하기'
category: Uncategoried
---
lsof 명령어는 굉장히 유용한 명령어 중 하나로 어느 프로세스가 파일을 사용하고 있는지 알려주는 명령어다.

가끔 mount를 해제하고 싶거나 특정 포트를 써야 하는데 막힌 경우 무척 유용하다.
예를 들어 /mnt/foo 를 마운트 해제하고 싶은데 만약에 어떤 사용자의 shell 이 /mnt/foo 를 보고 있으면
현재 그 장치가 바쁘다면서 해제가 안 될것이다.

이때 lsof 나 다른 명령어를 쓰라고 나오긴 한다. (옛날엔 자주 봤던 에러 메시지인데 그 메시지를 띄우기가 귀찮아서 생략한다)
물론 umount -f 로 해제해도 되지만 뭔가 -f 라서 꺼림칙하다.

이럴때는 **sudo lsof /mnt/foo** 를 하면 현재 그 디렉토리를 사용하고 있는 프로세스들의 목록이 뜬다.
그 다음 kill -9 를 써서 바로바로 그 프로세스들을 죽여주면 마운트를 해제할 수 있을 것이다.

또 다른 유용한 사용법은 위에서도 말했듯이 어느 프로세스가 포트를 잡고 있는지도 볼 수 있다는 것이다.
예를 들어

```sh
$ sudo lsof -i :5000
```

명령어를 사용하면 어느 프로세스가 이 포트를 쓰고 있는지 나오고 위에서 설명한 것처럼 **kill -9** 명렁어로 차분히 죽여주면 된다.
이 [링크를](http://susemi99.kr/643 "링크를") 읽으면 자세히 알 수 있다!

오늘 heroku flask 배포를 위해 한참 뻘짓을 하다가 발견한 사실이다..
하 php 는 개쉽던데 ..